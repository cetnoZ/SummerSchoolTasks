# Центрифуга 2.0

Время = 2сек. Память = 512мб.

## Сложность = ?

Однажды ученый-стажер Петя во время одного из использований аппарата "Центрифуга 2.0" для выделенияя ДНК из раствора решил не настраивать его перед включением, о чем было явно и четко написано в инструкции. В результате конфигурация главного механизма аппарата сбросилась, поэтому теперь время использования стало большим, и один запуск может занимать недели по оценкам аппарата.

Прочитав инструкцию Петя решил настроить главный механизм таким образом чтобы время работы центрифуги было как можно меньше. В документации написано, что механизм представляет собой бинарное дерево, состоящее из n пронуменованных узлов от 1 до n, на каждом из которых есть числа w<sub>i</sub> -- веса вершин. Петя вспомнил из программы первого курса в университете, что бинарное дерево обладает следующими свойствами:
* между любыми двумя узлами существует путь из последовательно соединенных ребрами узлов;
* каждый узел имеет не более 2х потомков -- левого и правого, соединенных ребрами с исходным узлом;
* имеется вершина 1, которая является корнем дерева.

Инструкция показывает, что время работы T центрифуги зависит от конфигурации главного механизма, а именно вычисляется по формуле:

T = w<sub>1</sub> * h<sub>1</sub> + w<sub>2</sub> * h<sub>2</sub> + ... + w<sub>n</sub> * h<sub>n</sub>

В которой w<sub>i</sub> -- вес i-й вершины, h<sub>i</sub> -- количество вершин на пути от корня до вершины i, включая оба конца пути.

Настройка состоит из последовательных поворотов ребер. Поворот ребра из u - v в v - u или наоборот происходит по следующей схеме:

![Rotation image](./resources/rotation.png?raw=true "Rotation image")

Из рисунка видно, что одна из вершин становиться выше другой, но при этом порядок вершин эйлерова обхода всего дерева не меняется, т.е. относительное расположение поддеревьев A, B и C остается прежним.

Помогите Пете починить аппарат, настроив главным механизм, выполняя некоторое количество вращений, таким образом, чтобы время работы было минимальным. 


## Входные данные

Первая строка входных данных содержит одно целое число n (1 <= n <= 500) -- количество узлов в главном механизме.

Далее следует n строк описывающие узлы механизма. i-й узел описывается тремя целыми числами l<sub>i</sub>, r<sub>i</sub> и w<sub>i</sub> (0 <= l<sub>i</sub>, r<sub>i</sub> <= n, 0 <= c<sub>i</sub> <= 10^9) -- правый и левый потомки узла i, а также вес i-го узла.

Гарантируется, что данные описывают корректное дерево.


## Выходные данные

В первой строке выведите одно число q (1 <= q <= 3 * 10 ^ 5) -- количество вращений дерева, необходимых для получения минимального времени работы аппарата.

На следующих q строках выведите по два числа разделенных пробелами в любом порядке v<sub>i</sub> и u<sub>i</sub> (1 <= v<sub>i</sub>, u<sub>i</sub> <= n) -- номера вершин ребра над которым выполняется вращение, при этом между этими вершинами должно ссуществовать ребро.

Если существует несколько способов настройки механизма, выведите любой из них.


### Входные данные

5<br>
5 0 3<br>
3 4 5<br>
0 0 4<br>
0 0 1<br>
2 0 2<br>

### Выходные данные

2<br>
5 1<br>
2 5<br>
