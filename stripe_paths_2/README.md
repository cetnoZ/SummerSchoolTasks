# Циклические нуклеотиды 2

Время = 2сек. Память = 512мб.

## Сложность = ?

После окончания анализа инопланетной ДНК принесенной всем известным зондом "Коммивояджер-3" ни для кого не секрет, что ДНК внеземных существ не является линейной, она напоминает больше напоминает дерево.

В этот раз ученые решили воссоздать инопланетных существ используя лишь их ДНК. Для этого очевидно требуются годы исследований и практики. Однако исследовательский центр "Лаборатория №1" знает как радикально ускорить расшифровку ДНК для предстоящего эксперимента по воссозданию пришельцев. План состоит в том, чтобы автоматизировать опыты с ДНК под управлением Искусственного Интеллекта (ИИ) и Aвтоматической Cтанции Манипулирования (АСМ) ДНК. Вас как опытного разработчика попросили написать эмулятор работы устройства АСМ для тестового запуска ИИ.

Как уже было сказано, ДНК состоит представляет собой множество из n пронумерованных от 1 до n узлов, некоторые из которых соединены одним из двух типов оснований. Известно, что ученые выбрали для первого раза один из примитивных видов, узлы ДНК которых образуют бинарное дерево с корнем в вершине 1, а значит:
* существует ровно один путь между любыми двумя узлами;
* любой узел ДНК содержит максимум два соединенных с ним узла, которые находятся ниже его.

Ученые уже привыкли называть нуклеотидом путь между двумя узлами, состоящем из последовательно соединенных основаниями узлов. Также нуклеотид называют "циклическим", если типы оснований соединений нуклеотида в порядке от его начального узла к конечному образуют "циклический" паттерн. "Циклическим" называют такую последовательность оснований ДНК, которая может быть разбита на положительное количество одинаковых сегментов, каждый из которых может быть представлен в виде k подряд идущих оснований типа 1, после которых идет k оснований типа 0 подряд, при некотором k > 0.

Чтобы удовлетворить условиям эксперимента эмулятор устройства АСМ должно уметь выполнять два вида запросов:
* 1 u<sub>j</sub> v<sub>j</sub> -- проверить являтся ли путь из u<sub>j</sub> в v<sub>j</sub> "циклическим" нуклеотидом;
* 2 u<sub>j</sub> v<sub>j</sub> k<sub>j</sub> -- изменить основания нуклеотида из узла u<sub>j</sub> в v<sub>j</sub> таким образом, чтобы он являлся "циклическим", при этом длина каждого сегмента была равна 2k.

Также для упрощения тестирования эмулятор всегда запускается с чистой ДНК, что означает перед началом выполнения запросов каждое все соединения в ДНК выполнены с использованием основания типа 0.

Помогите ученым с их разработками и напишите эмулятор устройства АСМ.
    
## Входные данные

Первая строка содержит целое число N (1 <= N <= 3 * 10 ^ 4) -- количество узлов в ДНК.

Следующие n строк описывают узлы ДНК. Строка описывающая i-й узел состоит из трех целых чисел l<sub>i</sub>, r<sub>i</sub> и c<sub>i</sub> (0 <= l<sub>i</sub>, r<sub>i</sub> <= N) -- правый и левый соседние узлы ДНК, которые находятся ниже i-го узла. Если правого либо левого соседнего узла не существует, тогда l<sub>i</sub> и/или r<sub>i</sub> будет равно 0.

Далее следует строка содержащая одно число Q (0 <= Q <= 3 * 10 ^ 4) -- количество запросов.

На следующих Q строках содержатся запросы -- по одному на каждой строке. Запрос j описывается одним из двух форматов:
* 1 u<sub>j</sub> v<sub>j</sub> -- для описания запроса первого вида (1 <= u<sub>j</sub>, v<sub>j</sub> <= N);
* 2 u<sub>j</sub> v<sub>j</sub> k -- для описания запроса второго вида (1 <= u<sub>j</sub> v<sub>j</sub> <= N, 1 <= k <= floor((N - 1) / 2)).

Гарантируется, что данные описывают корректное бинарное дерево, а также что для запросов второго типа 2 * k_j делит длину пути из u<sub>j</sub> в v<sub>j</sub>.

## Выходные данные

На каждый запрос первого типа выведите "Yes", если путь из u<sub>j</sub> в v<sub>j</sub> "циклическим", и "No" иначе.

### Входные данные

10<br>
0 2<br>
4 3<br>
9 7<br>
5 6<br>
0 0<br>
0 0<br>
8 0<br>
0 0<br>
0 10<br>
0 0<br>
10<br>
2 7 2 1<br>
2 3 1 1<br>
2 7 6 2<br>
2 5 9 1<br>
1 4 8<br>
1 7 9<br>
2 1 3 1<br>
2 9 7 1<br>
1 2 4<br>
2 4 1 1<br>


### Выходные данные

No<br>
Yes<br>
No<br>
